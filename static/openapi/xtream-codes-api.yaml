openapi: 3.0.3
info:
  title: Xtream Codes API
  description: |
    Comprehensive API documentation for Xtream Codes IPTV Panel v2.9.2

    ## Authentication
    All API requests require username and password as query parameters.

    ## Base URLs
    - HTTP: `http://server:25461`
    - HTTPS: `https://server:25463`
  version: 2.9.2
  contact:
    name: API Documentation
    url: https://github.com/worldofiptvcom/xtream-codes-api

servers:
  - url: http://{server}:{port}
    description: Xtream Codes Server
    variables:
      server:
        default: localhost
        description: Server hostname or IP
      port:
        default: "25461"
        description: Server port

tags:
  - name: Player API
    description: Client/Player API endpoints (/player_api.php)
  - name: Panel API
    description: Panel API endpoints (/panel_api.php)
  - name: Streaming
    description: Direct stream URLs
  - name: Playlists
    description: M3U playlist and EPG endpoints

paths:
  /player_api.php:
    get:
      tags:
        - Player API
      summary: Player API - Multiple Actions
      description: |
        The Player API endpoint. Without action parameter returns user/server info.
        With action parameter performs specific operations.

        **Available Actions:**
        - No action: Get user info and server info
        - `get_live_categories`: Get live TV categories
        - `get_live_streams`: Get live TV channels
        - `get_vod_categories`: Get VOD categories
        - `get_vod_streams`: Get VOD movies
        - `get_vod_info`: Get VOD movie details
        - `get_series_categories`: Get series categories
        - `get_series`: Get series list
        - `get_series_info`: Get series details with episodes
        - `get_short_epg`: Get EPG for a stream
        - `get_simple_data_table`: Get full EPG data
      operationId: playerApi
      parameters:
        - name: username
          in: query
          required: true
          description: Account username
          schema:
            type: string
          example: "demo"
        - name: password
          in: query
          required: true
          description: Account password
          schema:
            type: string
          example: "demo123"
        - name: action
          in: query
          required: false
          description: Action to perform (omit for user info)
          schema:
            type: string
            enum:
              - get_live_categories
              - get_live_streams
              - get_vod_categories
              - get_vod_streams
              - get_vod_info
              - get_series_categories
              - get_series
              - get_series_info
              - get_short_epg
              - get_simple_data_table
        - name: category_id
          in: query
          required: false
          description: Filter by category ID (for get_live_streams, get_vod_streams, get_series)
          schema:
            type: integer
        - name: vod_id
          in: query
          required: false
          description: VOD ID (required for get_vod_info)
          schema:
            type: integer
        - name: series_id
          in: query
          required: false
          description: Series ID (required for get_series_info)
          schema:
            type: integer
        - name: stream_id
          in: query
          required: false
          description: Stream ID (required for get_short_epg, get_simple_data_table)
          schema:
            type: integer
        - name: limit
          in: query
          required: false
          description: Limit results (for get_short_epg)
          schema:
            type: integer
            default: 10
      responses:
        '200':
          description: Successful response (varies by action)
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/UserInfo'
                  - $ref: '#/components/schemas/CategoryList'
                  - $ref: '#/components/schemas/LiveStreamList'
                  - $ref: '#/components/schemas/VodStreamList'
                  - $ref: '#/components/schemas/VodInfo'
                  - $ref: '#/components/schemas/SeriesList'
                  - $ref: '#/components/schemas/SeriesInfo'
                  - $ref: '#/components/schemas/EpgListings'
        '401':
          description: Authentication failed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthError'

  /panel_api.php:
    get:
      tags:
        - Panel API
      summary: Panel API - Full Data
      description: |
        Panel API endpoint for panel applications.
        Returns comprehensive data including all categories and streams.

        **Available Actions:**
        - No action: Get full account data
        - `get_epg`: Get EPG for specific stream
      operationId: panelApi
      parameters:
        - name: username
          in: query
          required: true
          description: Account username
          schema:
            type: string
        - name: password
          in: query
          required: true
          description: Account password
          schema:
            type: string
        - name: action
          in: query
          required: false
          schema:
            type: string
            enum:
              - get_epg
        - name: stream_id
          in: query
          required: false
          description: Stream ID (for get_epg action)
          schema:
            type: integer
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PanelData'

  /get.php:
    get:
      tags:
        - Playlists
      summary: Get M3U Playlist
      description: Generate M3U/M3U8 playlist for IPTV players
      operationId: getPlaylist
      parameters:
        - name: username
          in: query
          required: true
          schema:
            type: string
        - name: password
          in: query
          required: true
          schema:
            type: string
        - name: type
          in: query
          required: true
          description: Playlist type
          schema:
            type: string
            enum:
              - m3u_plus
              - m3u
        - name: output
          in: query
          required: false
          description: Stream output format
          schema:
            type: string
            enum:
              - ts
              - m3u8
              - rtmp
            default: ts
      responses:
        '200':
          description: M3U playlist file
          content:
            audio/x-mpegurl:
              schema:
                type: string
                example: |
                  #EXTM3U
                  #EXTINF:-1 tvg-id="ch1" tvg-name="Channel 1",Channel 1
                  http://server:25461/user/pass/1.ts

  /xmltv.php:
    get:
      tags:
        - Playlists
      summary: Get XMLTV EPG
      description: Get Electronic Program Guide in XMLTV format
      operationId: getXmltv
      parameters:
        - name: username
          in: query
          required: true
          schema:
            type: string
        - name: password
          in: query
          required: true
          schema:
            type: string
      responses:
        '200':
          description: XMLTV EPG data
          content:
            application/xml:
              schema:
                type: string

  /live/{username}/{password}/{stream_id}.ts:
    get:
      tags:
        - Streaming
      summary: Live TV Stream (MPEG-TS)
      description: Stream live TV channel in MPEG-TS format
      operationId: streamLiveTs
      parameters:
        - name: username
          in: path
          required: true
          schema:
            type: string
        - name: password
          in: path
          required: true
          schema:
            type: string
        - name: stream_id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Live video stream
          content:
            video/mp2t:
              schema:
                type: string
                format: binary

  /live/{username}/{password}/{stream_id}.m3u8:
    get:
      tags:
        - Streaming
      summary: Live TV Stream (HLS)
      description: Stream live TV channel in HLS format
      operationId: streamLiveHls
      parameters:
        - name: username
          in: path
          required: true
          schema:
            type: string
        - name: password
          in: path
          required: true
          schema:
            type: string
        - name: stream_id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: HLS playlist
          content:
            application/vnd.apple.mpegurl:
              schema:
                type: string

  /{username}/{password}/{stream_id}.ts:
    get:
      tags:
        - Streaming
      summary: Live TV Stream (Short URL)
      description: Alternative short URL format for live TV
      operationId: streamLiveShort
      parameters:
        - name: username
          in: path
          required: true
          schema:
            type: string
        - name: password
          in: path
          required: true
          schema:
            type: string
        - name: stream_id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Live video stream
          content:
            video/mp2t:
              schema:
                type: string
                format: binary

  /movie/{username}/{password}/{vod_id}.{ext}:
    get:
      tags:
        - Streaming
      summary: VOD Movie Stream
      description: Stream VOD movie content
      operationId: streamVod
      parameters:
        - name: username
          in: path
          required: true
          schema:
            type: string
        - name: password
          in: path
          required: true
          schema:
            type: string
        - name: vod_id
          in: path
          required: true
          schema:
            type: integer
        - name: ext
          in: path
          required: true
          description: File extension (mkv, mp4, avi)
          schema:
            type: string
            enum:
              - mkv
              - mp4
              - avi
      responses:
        '200':
          description: VOD video stream
          content:
            video/*:
              schema:
                type: string
                format: binary

  /series/{username}/{password}/{episode_id}.{ext}:
    get:
      tags:
        - Streaming
      summary: Series Episode Stream
      description: Stream TV series episode
      operationId: streamEpisode
      parameters:
        - name: username
          in: path
          required: true
          schema:
            type: string
        - name: password
          in: path
          required: true
          schema:
            type: string
        - name: episode_id
          in: path
          required: true
          schema:
            type: integer
        - name: ext
          in: path
          required: true
          description: File extension (mkv, mp4, avi)
          schema:
            type: string
            enum:
              - mkv
              - mp4
              - avi
      responses:
        '200':
          description: Episode video stream
          content:
            video/*:
              schema:
                type: string
                format: binary

  /timeshift/{username}/{password}/{duration}/{start}/{stream_id}.ts:
    get:
      tags:
        - Streaming
      summary: Timeshift Stream
      description: Stream past content using timeshift/catchup
      operationId: streamTimeshift
      parameters:
        - name: username
          in: path
          required: true
          schema:
            type: string
        - name: password
          in: path
          required: true
          schema:
            type: string
        - name: duration
          in: path
          required: true
          description: Duration in minutes
          schema:
            type: integer
        - name: start
          in: path
          required: true
          description: Start time (YYYY-MM-DD:HH-MM)
          schema:
            type: string
            example: "2024-01-15:14-00"
        - name: stream_id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Timeshift video stream
          content:
            video/mp2t:
              schema:
                type: string
                format: binary

components:
  schemas:
    UserInfo:
      type: object
      description: User and server information (returned without action parameter)
      properties:
        user_info:
          type: object
          properties:
            username:
              type: string
              example: "demo"
            password:
              type: string
              example: "demo123"
            message:
              type: string
            auth:
              type: integer
              enum: [0, 1]
              example: 1
            status:
              type: string
              enum: [Active, Banned, Disabled, Expired]
              example: "Active"
            exp_date:
              type: string
              nullable: true
              example: "1735689600"
            is_trial:
              type: string
              example: "0"
            active_cons:
              type: string
              example: "0"
            created_at:
              type: string
              example: "1609459200"
            max_connections:
              type: string
              example: "1"
            allowed_output_formats:
              type: array
              items:
                type: string
              example: ["ts", "m3u8", "rtmp"]
        server_info:
          type: object
          properties:
            url:
              type: string
              example: "server.example.com"
            port:
              type: string
              example: "25461"
            https_port:
              type: string
              example: "25463"
            server_protocol:
              type: string
              example: "http"
            rtmp_port:
              type: string
              example: "25462"
            timezone:
              type: string
              example: "Europe/London"
            timestamp_now:
              type: integer
              example: 1705320000
            time_now:
              type: string
              example: "2024-01-15 12:00:00"

    AuthError:
      type: object
      properties:
        user_info:
          type: object
          properties:
            auth:
              type: integer
              example: 0
            status:
              type: string
              example: "Expired"
            message:
              type: string
              example: "Account has expired"

    CategoryList:
      type: array
      items:
        $ref: '#/components/schemas/Category'

    Category:
      type: object
      properties:
        category_id:
          type: string
          example: "1"
        category_name:
          type: string
          example: "Sports"
        parent_id:
          type: integer
          example: 0

    LiveStreamList:
      type: array
      items:
        $ref: '#/components/schemas/LiveStream'

    LiveStream:
      type: object
      properties:
        num:
          type: integer
          example: 1
        name:
          type: string
          example: "ESPN HD"
        stream_type:
          type: string
          example: "live"
        stream_id:
          type: integer
          example: 12345
        stream_icon:
          type: string
          example: "http://server/logos/espn.png"
        epg_channel_id:
          type: string
          nullable: true
          example: "espn.us"
        added:
          type: string
          example: "1609459200"
        category_id:
          type: string
          example: "1"
        custom_sid:
          type: string
        tv_archive:
          type: integer
          description: "1 = timeshift enabled, 0 = disabled"
          example: 1
        direct_source:
          type: string
        tv_archive_duration:
          type: integer
          description: Days of archive available
          example: 7

    VodStreamList:
      type: array
      items:
        $ref: '#/components/schemas/VodStream'

    VodStream:
      type: object
      properties:
        num:
          type: integer
          example: 1
        name:
          type: string
          example: "Movie Title"
        stream_type:
          type: string
          example: "movie"
        stream_id:
          type: integer
          example: 67890
        stream_icon:
          type: string
          example: "http://server/posters/movie.jpg"
        rating:
          type: string
          example: "8.5"
        rating_5based:
          type: number
          example: 4.25
        added:
          type: string
          example: "1609459200"
        category_id:
          type: string
          example: "5"
        container_extension:
          type: string
          example: "mkv"

    VodInfo:
      type: object
      properties:
        info:
          type: object
          properties:
            movie_image:
              type: string
            tmdb_id:
              type: string
            backdrop_path:
              type: array
              items:
                type: string
            youtube_trailer:
              type: string
            genre:
              type: string
            plot:
              type: string
            cast:
              type: string
            rating:
              type: string
            director:
              type: string
            releasedate:
              type: string
            duration_secs:
              type: integer
            duration:
              type: string
        movie_data:
          type: object
          properties:
            stream_id:
              type: integer
            name:
              type: string
            added:
              type: string
            category_id:
              type: string
            container_extension:
              type: string

    SeriesList:
      type: array
      items:
        $ref: '#/components/schemas/Series'

    Series:
      type: object
      properties:
        num:
          type: integer
        name:
          type: string
        series_id:
          type: integer
        cover:
          type: string
        plot:
          type: string
        cast:
          type: string
        director:
          type: string
        genre:
          type: string
        releaseDate:
          type: string
        rating:
          type: string
        rating_5based:
          type: number
        backdrop_path:
          type: array
          items:
            type: string
        youtube_trailer:
          type: string
        category_id:
          type: string

    SeriesInfo:
      type: object
      properties:
        seasons:
          type: array
          items:
            type: object
            properties:
              season_number:
                type: integer
              name:
                type: string
              episode_count:
                type: integer
              cover:
                type: string
        info:
          type: object
          properties:
            name:
              type: string
            cover:
              type: string
            plot:
              type: string
            cast:
              type: string
            director:
              type: string
            genre:
              type: string
            releaseDate:
              type: string
            rating:
              type: string
        episodes:
          type: object
          description: Episodes grouped by season number
          additionalProperties:
            type: array
            items:
              $ref: '#/components/schemas/Episode'

    Episode:
      type: object
      properties:
        id:
          type: string
        episode_num:
          type: integer
        title:
          type: string
        container_extension:
          type: string
        info:
          type: object
          properties:
            duration_secs:
              type: integer
            duration:
              type: string
            movie_image:
              type: string
            plot:
              type: string
            releasedate:
              type: string

    EpgListings:
      type: object
      properties:
        epg_listings:
          type: array
          items:
            type: object
            properties:
              id:
                type: string
              epg_id:
                type: string
              title:
                type: string
              lang:
                type: string
              start:
                type: string
              end:
                type: string
              description:
                type: string
              channel_id:
                type: string
              start_timestamp:
                type: integer
              stop_timestamp:
                type: integer

    PanelData:
      type: object
      description: Full panel data response
      properties:
        user_info:
          $ref: '#/components/schemas/UserInfo/properties/user_info'
        server_info:
          $ref: '#/components/schemas/UserInfo/properties/server_info'
        categories:
          type: object
          properties:
            live:
              type: array
              items:
                $ref: '#/components/schemas/Category'
            movie:
              type: array
              items:
                $ref: '#/components/schemas/Category'
            series:
              type: array
              items:
                $ref: '#/components/schemas/Category'
        available_channels:
          type: array
          items:
            $ref: '#/components/schemas/LiveStream'
